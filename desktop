#!/usr/bin/env bash

if [ "$EUID" -eq 0 ]; then
    echo "Please don't run this as root."
    exit 1
fi

set -eux

mkdir -p $HOME/.config/zed
mkdir -p $HOME/.gnupg
mkdir -p $HOME/.local/bin
mkdir -p $HOME/.local/share/fonts
mkdir -p $HOME/.local/share/applications
rm $HOME/.bashrc $HOME/.bash_profile

# config
stow Home -t ~/

# shell
sudo usermod -a -G wireshark $USER

# asdf
git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.14.0
. "$HOME/.asdf/asdf.sh"

# golang
asdf plugin add golang
asdf install golang latest
asdf global golang latest

# npm
asdf plugin add nodejs
asdf install nodejs latest
asdf global nodejs latest

# zed
curl https://zed.dev/install.sh | bash

# flatpaks
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
flatpak remote-modify flathub --enable

flatpak install -y flathub org.gtk.Gtk3theme.adw-gtk3 org.gtk.Gtk3theme.adw-gtk3-dark

flatpak install -y flathub com.obsproject.Studio io.github.seadve.Kooha \
    io.mpv.Mpv

flatpak install -y flathub org.gnome.Papers org.onlyoffice.desktopeditors \
    org.gnome.World.Secrets de.haeckerfelix.Fragments org.gnome.Loupe \
    org.gnome.clocks

flatpak install -y flathub com.valvesoftware.Steam com.modrinth.ModrinthApp \
    net.waterfox.waterfox

# font
wget -q https://befonts.com/wp-content/uploads/2021/12/lexend-main.zip
unzip lexend-main.zip
sudo mkdir -p /usr/share/fonts/lexend/
sudo cp lexend-main/fonts/lexend/ttf/* /usr/share/fonts/lexend/
rm lexend-main.zip
rm -rf lexend-main
fc-cache

# desktop
gsettings set org.gnome.desktop.interface clock-format '24h'
gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
gsettings set org.gnome.desktop.interface gtk-theme 'adw-gtk3-dark'
gsettings set org.gnome.desktop.interface monospace-font-name 'JetBrains Mono 13'
gsettings set org.gnome.desktop.interface font-name 'Lexend 11'
gsettings set org.gnome.desktop.interface document-font-name 'Lexend 11'
gsettings set org.gnome.desktop.interface icon-theme "Papirus-Dark"
