#!/bin/bash

if [ "$EUID" -ne 0 ]; then
    echo "Please run this as root."
    exit 1
fi

set -euxo pipefail

dnf remove -y firefox gnome-maps totem nome-boxes gnome-weather rhythmbox baobab ptyxis evince \
    gnome-connections gnome-logs mediawriter gnome-software simple-scan gnome-contacts gnome-abrt \
    gnome-font-viewer gnome-tour gnome-calculator gnome-system-monitor gnome-boxes gnome-text-editor

dnf install -y https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm 
dnf install -y https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm

rpm --import https://packages.microsoft.com/keys/microsoft.asc
echo -e "[code]\nname=Visual Studio Code\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\nenabled=1\ngpgcheck=1\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" | tee /etc/yum.repos.d/vscode.repo > /dev/null

dnf swap -y ffmpeg-free ffmpeg --allowerasing
dnf swap -y mesa-va-drivers mesa-va-drivers-freeworld
dnf swap -y mesa-vdpau-drivers mesa-vdpau-drivers-freeworld

dnf install -y adw-gtk3-theme cascadia-code-nf-fonts rsms-inter-vf-fonts gnome-tweaks chromium \
    code

dnf install -y kitty @development-tools stow neovim wl-clipboard p7zip p7zip-plugins nmap ansible \
    opentofu strace btop htop

dnf autoremove -y

# kitty for gnome hack
ln -s /usr/bin/kitty /usr/bin/gnome-terminal